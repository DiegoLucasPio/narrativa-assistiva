<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Narrativa Inclusiva - Vers√£o Final</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: #f4f7f6; text-align: center; padding: 10px; }
        .painel-botoes { display: flex; justify-content: center; gap: 8px; margin-bottom: 15px; flex-wrap: wrap; }
        
        .btn-acao { 
            padding: 15px 20px; font-size: 0.9rem; font-weight: bold; border: none; 
            border-radius: 10px; cursor: pointer; color: white; transition: 0.2s; box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .btn-ouvir { background: #e74c3c; } 
        .btn-descrever { background: #3498db; }
        .btn-ler { background: #27ae60; }
        .btn-sinonimo { background: #9b59b6; }
        .btn-salvar { background: #f39c12; }
        .btn-acao:active { transform: translateY(2px); }

        .quadros { display: flex; justify-content: center; gap: 15px; margin: 15px 0; }
        .cena { width: 260px; background: white; border-radius: 12px; padding: 10px; border: 2px solid #ddd; }
        .cena img { width: 100%; height: 160px; object-fit: cover; border-radius: 8px; }
        .cena strong { display: block; margin-top: 8px; color: #2c3e50; font-size: 1.1rem; }
        .cena p { font-size: 0.85rem; color: #666; line-height: 1.3; }

        textarea { width: 90%; height: 160px; font-size: 1.6rem; padding: 15px; border: 4px solid #3498db; border-radius: 15px; margin-top: 5px; outline: none; }
        #status { margin: 10px; font-weight: bold; color: #2c3e50; min-height: 1.5em; background: #fff; display: inline-block; padding: 5px 15px; border-radius: 20px; }
    </style>
</head>
<body>

    <div id="status">Pressione F1, F2, F3 ou F4</div>

    <div class="painel-botoes">
        <button class="btn-acao btn-ouvir" onclick="ativarVoz()">üé§ VOZ (CLIQUE E FALE)</button>
        <button class="btn-acao btn-descrever" onclick="comandoDescrever()">üñºÔ∏è CENAS (F1)</button>
        <button class="btn-acao btn-ler" onclick="comandoLer()">üìñ LER (F2)</button>
        <button class="btn-acao btn-sinonimo" onclick="comandoSinonimo()">üîÑ SIN√îNIMO (F3)</button>
        <button class="btn-acao btn-salvar" onclick="comandoSalvar()">üíæ SALVAR (F4)</button>
    </div>

    <div class="quadros">
        <div class="cena">
            <img src="https://images.unsplash.com/photo-1519074063912-ad25b5ce4970?w=400" alt="Cena 1">
            <strong>1. O In√≠cio</strong>
            <p>Um explorador encontra um mapa antigo enterrado na areia da floresta azul.</p>
        </div>
        <div class="cena">
            <img src="https://images.unsplash.com/photo-1444076784383-69fc7bad9006?w=400" alt="Cena 2">
            <strong>2. O Meio</strong>
            <p>Para seguir o mapa, ele deve atravessar uma ponte de madeira muito alta e velha.</p>
        </div>
        <div class="cena">
            <img src="https://images.unsplash.com/photo-1509114397022-ed747cca3f65?w=400" alt="Cena 3">
            <strong>3. O Fim</strong>
            <p>Dentro de uma caverna brilhante, ele finalmente encontra o grande ba√∫ de ouro.</p>
        </div>
    </div>

    <textarea id="meuTexto" placeholder="Escreva sua hist√≥ria aqui..."></textarea>

    <script>
        const campo = document.getElementById('meuTexto');
        const status = document.getElementById('status');
        const synth = window.speechSynthesis;

        // DICION√ÅRIO AMPLIADO
        const dicionario = {
            "olhar": ["ver", "observar", "contemplar", "enxergar"],
            "feliz": ["alegre", "contente", "satisfeito", "radiante", "jubiloso"],
            "triste": ["chateado", "desanimado", "melanc√≥lico", "tristonho"],
            "medo": ["receio", "temor", "pavor", "susto"],
            "grande": ["enorme", "gigante", "imenso", "colossal"],
            "pequeno": ["min√∫sculo", "mi√∫do", "curto"],
            "bonito": ["belo", "lindo", "maravilhoso", "encantador"],
            "casa": ["lar", "moradia", "resid√™ncia", "abrigo"],
            "achar": ["encontrar", "localizar", "descobrir"],
            "caminhar": ["andar", "passar", "marchar", "seguir"],
            "falar": ["dizer", "contar", "exclamar", "conversar"],
            "bravo": ["irritado", "furioso", "zangado"],
            "comida": ["alimento", "refei√ß√£o", "lanche"],
            "amigo": ["colega", "parceiro", "companheiro"],
            "ouro": ["tesouro", "riqueza", "moedas"]
        };

        function falar(t) {
            synth.cancel();
            const u = new SpeechSynthesisUtterance(t);
            u.lang = 'pt-BR';
            synth.speak(u);
        }

        function comandoDescrever() {
            falar("Sequ√™ncia da hist√≥ria. Cena 1: In√≠cio, o explorador acha um mapa na floresta. Cena 2: Meio, ele atravessa uma ponte alta e perigosa. Cena 3: Fim, ele encontra o ba√∫ de ouro na caverna.");
        }

        function comandoLer() {
            falar(campo.value || "Voc√™ ainda n√£o escreveu nada.");
        }

        function comandoSinonimo() {
            const texto = campo.value.trim();
            if (!texto) {
                falar("Escreva uma palavra antes de pedir o sin√¥nimo.");
                return;
            }
            const palavras = texto.split(/\s+/);
            const ultima = palavras[palavras.length - 1].toLowerCase().replace(/[.,!?;]/g, "");
            
            if (dicionario[ultima]) {
                const opcoes = dicionario[ultima].join(", ");
                falar(`Sin√¥nimos de ${ultima}: ${opcoes}`);
                status.innerText = `Sin√¥nimos: ${opcoes}`;
            } else {
                falar("Ainda n√£o tenho sin√¥nimos para a palavra " + ultima);
                status.innerText = "Palavra n√£o encontrada.";
            }
        }

        function comandoSalvar() {
            const blob = new Blob([campo.value], {type: 'text/plain'});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'historia_criativa.txt';
            a.click();
            falar("Sua hist√≥ria foi salva.");
        }

        // TECLADO (F1-F4)
        window.onkeydown = function(e) {
            if (e.keyCode === 112) { e.preventDefault(); comandoDescrever(); }
            if (e.keyCode === 113) { e.preventDefault(); comandoLer(); }
            if (e.keyCode === 114) { e.preventDefault(); comandoSinonimo(); }
            if (e.keyCode === 115) { e.preventDefault(); comandoSalvar(); }
        };

        // VOZ (PUSH-TO-TALK)
        function ativarVoz() {
            const Recognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (!Recognition) return;

            const rec = new Recognition();
            rec.lang = 'pt-BR';
            rec.continuous = false; // MODO SEGURO: Ele ouve uma vez e para

            rec.onstart = () => { status.innerText = "üé§ Ouvindo comando..."; };
            rec.onerror = (e) => { 
                status.innerText = "Erro: " + e.error; 
                console.log("Erro de Voz:", e.error);
            };
            
            rec.onresult = (event) => {
                const fala = event.results[0][0].transcript.toLowerCase();
                status.innerText = "Ouvi: " + fala;
                if (fala.includes("descrever")) comandoDescrever();
                else if (fala.includes("ler") || fala.includes("leitura")) comandoLer();
                else if (fala.includes("sin√¥nimo")) comandoSinonimo();
                else if (fala.includes("salvar")) comandoSalvar();
            };
            rec.start();
        }
    </script>
</body>
</html>

