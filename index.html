<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Narrativa Inclusiva - Vers√£o 100% Funcional</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; text-align: center; padding: 10px; }
        .painel-botoes { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        
        /* Bot√µes Gigantes para facilitar o clique */
        .btn-acao { 
            padding: 20px; font-size: 1.1rem; font-weight: bold; border: none; 
            border-radius: 12px; cursor: pointer; color: white; min-width: 150px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2); transition: 0.2s;
        }
        .btn-ouvir { background: #e74c3c; } /* Vermelho */
        .btn-descrever { background: #3498db; } /* Azul */
        .btn-ler { background: #27ae60; } /* Verde */
        .btn-salvar { background: #f39c12; } /* Laranja */
        .btn-acao:active { transform: scale(0.95); }

        .quadros { display: flex; justify-content: center; gap: 10px; margin: 20px 0; }
        .cena { width: 180px; background: white; border-radius: 10px; padding: 5px; border: 1px solid #ccc; }
        .cena img { width: 100%; border-radius: 5px; }

        textarea { width: 90%; height: 200px; font-size: 1.8rem; padding: 15px; border: 4px solid #3498db; border-radius: 15px; }
        #status { margin: 15px; font-weight: bold; color: #2c3e50; font-size: 1.2rem; }
    </style>
</head>
<body>

    <div id="status">Pressione os bot√µes ou use as teclas (F1, F2, F4)</div>

    <div class="painel-botoes">
        <button class="btn-acao btn-ouvir" onclick="ativarVoz()">üé§ LIGAR VOZ</button>
        <button class="btn-acao btn-descrever" onclick="comandoDescrever()">üñºÔ∏è DESCREVER (F1)</button>
        <button class="btn-acao btn-ler" onclick="comandoLer()">üìñ LER TEXTO (F2)</button>
        <button class="btn-acao btn-salvar" onclick="comandoSalvar()">üíæ SALVAR (F4)</button>
    </div>

    <div class="quadros">
        <div class="cena"><img src="https://picsum.photos/seed/1/200/150"><div>Cena 1</div></div>
        <div class="cena"><img src="https://picsum.photos/seed/2/200/150"><div>Cena 2</div></div>
        <div class="cena"><img src="https://picsum.photos/seed/3/200/150"><div>Cena 3</div></div>
    </div>

    <textarea id="meuTexto" placeholder="Escreva sua hist√≥ria aqui..."></textarea>

    <script>
        const campo = document.getElementById('meuTexto');
        const status = document.getElementById('status');
        const synth = window.speechSynthesis;

        // --- FUN√á√ïES DE COMANDO ---
        function falar(t) {
            synth.cancel();
            const u = new SpeechSynthesisUtterance(t);
            u.lang = 'pt-BR';
            synth.speak(u);
        }

        function comandoDescrever() {
            falar("Cena 1: Uma floresta m√°gica. Cena 2: Um ba√∫ escondido. Cena 3: Um menino feliz.");
            status.innerText = "Descrevendo imagens...";
        }

        function comandoLer() {
            const t = campo.value || "O campo de texto est√° vazio.";
            falar(t);
            status.innerText = "Lendo sua hist√≥ria...";
        }

        function comandoSalvar() {
            const blob = new Blob([campo.value], {type: 'text/plain'});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'historia.txt';
            a.click();
            falar("Sua hist√≥ria foi salva no computador.");
        }

        // --- ATALHOS DE TECLADO (FOR√áADOS) ---
        window.onkeydown = function(e) {
            // F1
            if (e.keyCode === 112) { e.preventDefault(); comandoDescrever(); }
            // F2
            if (e.keyCode === 113) { e.preventDefault(); comandoLer(); }
            // F4
            if (e.keyCode === 115) { e.preventDefault(); comandoSalvar(); }
        };

        // --- RECONHECIMENTO DE VOZ (SEM LOOP) ---
        function ativarVoz() {
            const Recognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (!Recognition) {
                falar("Seu navegador n√£o suporta voz.");
                return;
            }

            const rec = new Recognition();
            rec.lang = 'pt-BR';
            
            rec.onstart = () => { status.innerText = "Ouvindo... Fale agora!"; };
            rec.onerror = (e) => { status.innerText = "Erro no microfone: " + e.error; };
            
            rec.onresult = (event) => {
                const fala = event.results[0][0].transcript.toLowerCase();
                status.innerText = "Ouvi: " + fala;
                if (fala.includes("descrever")) comandoDescrever();
                else if (fala.includes("ler") || fala.includes("leitura")) comandoLer();
                else if (fala.includes("salvar")) comandoSalvar();
            };

            rec.start();
        }
    </script>
</body>
</html>
